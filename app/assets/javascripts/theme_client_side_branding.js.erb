<% require_relative '../../../lib/foreman_theme_satellite/branded_words' %>

var branded_words = []
<% ForemanThemeSatellite::FOREMAN_BRAND.map do |exp, replace|  %>
branded_words.push([new RegExp("<%= exp.source.gsub('\\', '\\\\\\') %>", "g"), "<%= replace %>"]);
<% end %>

function brand_string(string){
  result = string;
  branded_words.forEach(function(tuple){
    regex = tuple[0];
    value = tuple[1];
    result = result.replace(regex, value);
  });
  return result;
}

i18n.original_jed = i18n.dcnpgettext

i18n.dcnpgettext = function( domain, context, singular_key, plural_key, val ) {
  translated = i18n.original_jed( domain, context, singular_key, plural_key, val );

  return brand_string(translated);
}

if (typeof(angular) !== 'undefined') {
  angular.module('Bastion.i18n').config([ '$provide', function($provide) {
    $provide.decorator('translate', [
      '$delegate',
      function ($delegate) {
        var originalTranslate = $delegate;
        return function(str) {
          originalStr = originalTranslate(str);
          return brand_string(originalStr);
        }
      }
    ]);
  }]);
}
